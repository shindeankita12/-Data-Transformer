Â                              DataTransformer Project:-


(1.) CREATE TABLE Customers (
  CustomerID INT PRIMARY KEY,
  FirstName VARCHAR(50),
  LastName VARCHAR(50),
  Email VARCHAR(100),
  RegistrationDate DATE
);

Sample Data:
 INSERT INTO Customers (CustomerID, FirstName, LastName, Email, RegistrationDate) VALUES
 (1, 'John', 'Doe', ' john.doe@email.com  ', '2022-03-15'), 
 (2, 'Jane', 'Smith', 'jane.smith@email.com', '2021-11-02');


(2.) CREATE TABLE Orders (
  OrderID INT PRIMARY KEY,
  CustomerID INT,
  OrderDate DATE,
  TotalAmount DECIMAL(10,2),
  FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);


Sample DATA:
INSERT INTO Orders (OrderID, CustomerID, OrderDate, TotalAmount) VALUES
  (101, 1, '2023-07-01', 150.50),
  (102, 2, '2023-07-03', 200.75);



(3.) CREATE TABLE Employees (
  EmployeeID INT PRIMARY KEY,
  FirstName VARCHAR(50) NOT NULL,
  LastName VARCHAR(50)NOT NULL,
  Department VARCHAR(50),
  HireDate DATE,
  Salary DECIMAL(12,2)
);


Sample Data:
INSERT INTO Employees (EmployeeID, FirstName, LastName, Department, HireDate, Salary) VALUES
  (1, 'Mark', 'Johnson', 'Sales', '2020-01-15', 50000.00),
  (2, 'Susan', 'Lee', 'HR', '2021-03-20', 55000.00);



QUERIES TO PERFORM:
(1.) SELECT
        o.OrderID, o.CustomerID, o.OrderDate, o.TotalAmount,
        c.FirstName, c.LastName, c.Email
     FROM Orders AS o
     INNER JOIN Customers AS c
        ON o.CustomerID = c.CustomerID;




(2.) SELECT
         c.CustomerID, c.FirstName, c.LastName, c.Email,
         o.OrderID, o.OrderDate, o.TotalAmount
     FROM Customers AS c
     LEFT JOIN Orders AS o
         ON c.CustomerID = o.CustomerID
     ORDER BY c.CustomerID, o.OrderDate;



(3.) SELECT
        o.OrderID, o.CustomerID, o.OrderDate, o.TotalAmount,
        c.FirstName, c.LastName, c.Email
     FROM Customers AS c
     RIGHT JOIN Orders AS o
        ON c.CustomerID = o.CustomerID
     ORDER BY o.OrderID;



(4.) SELECT
        c.CustomerID, c.FirstName, c.LastName, c.Email,
        o.OrderID, o.OrderDate, o.TotalAmount
     FROM Customers AS c
     LEFT JOIN Orders AS o
        ON c.CustomerID = o.CustomerID

     UNION

     SELECT
       c.CustomerID, c.FirstName, c.LastName, c.Email,
       o.OrderID, o.OrderDate, o.TotalAmount
     FROM Customers AS c
     RIGHT JOIN Orders AS o
       ON c.CustomerID = o.CustomerID
     WHERE c.CustomerID IS NULL;




(5.) SELECT DISTINCT c.CustomerID, c.FirstName, c.LastName, c.Email
     FROM Customers AS c
     JOIN Orders AS o ON c.CustomerID = o.CustomerID
     WHERE o.TotalAmount > (SELECT AVG(TotalAmount) FROM Orders);




(6.) SELECT e.EmployeeID, e.FirstName, e.LastName, e.Department, e.Salary
     FROM Employees AS e
     WHERE e.Salary > (SELECT AVG(Salary) FROM Employees);




(7.) SELECT
       OrderID,
       YEAR(OrderDate) AS OrderYear,
       MONTH(OrderDate) AS OrderMonth
     FROM Orders;




(8.) SELECT
       OrderID,
       OrderDate,
       DATEDIFF(CURDATE(), OrderDate) AS DaysSinceOrder
    FROM Orders;




(9.) SELECT
       OrderID,
       DATE_FORMAT(OrderDate, '%d-%b-%Y') AS PrettyOrderDate
     FROM Orders;




(10.) SELECT
        CustomerID,
        CONCAT(FirstName, ' ', LastName) AS FullName
      FROM Customers;



(11.) SELECT
        CustomerID,
        FirstName,
        REPLACE(FirstName, 'John', 'Jonathans') AS FirstName_Replaced
      FROM Customers;





(12.) SELECT
        CustomerID,
        UPPER(FirstName) AS FirstName_UPPER,
        LOWER(LastName) AS LastName_lower
      FROM Customers;






(13.) UPDATE Customers
         SET Email = TRIM(Email);
      SELECT CustomerID, Email FROM Customers;





(14.)SELECT 
  o1.OrderID,
  o1.CustomerID,
  o1.OrderDate,
  o1.TotalAmount,
  (
    SELECT SUM(o2.TotalAmount)
    FROM Orders o2
    WHERE o2.CustomerID = o1.CustomerID
      AND o2.OrderDate <= o1.OrderDate
  ) AS RunningTotal
FROM Orders o1
ORDER BY o1.CustomerID, o1.OrderDate;





(15.) SELECT 
  o1.OrderID,
  o1.CustomerID,
  o1.TotalAmount,
  (
    SELECT COUNT(DISTINCT o2.TotalAmount)
    FROM Orders o2
    WHERE o2.TotalAmount > o1.TotalAmount
  ) + 1 AS RankPosition
FROM Orders o1
ORDER BY RankPosition;





(16.) SELECT
        OrderID,
        TotalAmount,
      CASE
        WHEN TotalAmount > 1000 THEN 0.10
        WHEN TotalAmount <= 500 THEN 0.05
        ELSE 0.07
      END AS DiscountRate,
      ROUND(TotalAmount * CASE
        WHEN TotalAmount > 1000 THEN 0.10
        WHEN TotalAmount <= 500 THEN 0.05
        ELSE 0.07
      END, 2) AS DiscountAmount,
      ROUND(TotalAmount - (TotalAmount * CASE
        WHEN TotalAmount > 1000 THEN 0.10
        WHEN TotalAmount <= 500 THEN 0.05
        ELSE 0.07
      END), 2) AS NetPayable
     FROM Orders
     ORDER BY TotalAmount DESC;





(17.) SELECT
        EmployeeID,
        FirstName,
        LastName,
        Salary,
        CASE
          WHEN Salary >= 80000 THEN 'High'
          WHEN Salary >= 50000 THEN 'Medium'
          ELSE 'Low'
       END AS SalaryCategory
     FROM Employees
     ORDER BY Salary DESC;



 



